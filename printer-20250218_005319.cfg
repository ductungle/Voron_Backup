#####################################################################
#   Device ID's
#####################################################################
[mcu rpi]
serial: /tmp/klipper_host_mcu
[include fluidd.cfg]

#####################################################################
#   Happy Hare includes
#####################################################################
[include mmu/addons/mmu_erec_cutter.cfg]

[include mmu/base/*.cfg]
[include mmu/optional/client_macros.cfg]
##[include mmu/optional/mmu_ercf_compat.cfg]
[include mmu/optional/mmu_menu.cfg]
[include mmu/addons/blobifier.cfg]
[include mmu/base/mmu_filametrix.cfg]

#####################################################################
#   Configs
#####################################################################
[include configs/sb2209USB.cfg]
[include configs/cartographer.cfg]

#####################################################################
#   Includes
#####################################################################
[include print_area_bed_mesh.cfg]
#[include autoZ.cfg]

[exclude_object] 



[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32f446xx_0F002B000650534841313020-if00
[input_shaper]
#shaper_freq_x: 61
#shaper_type_x: mzv
#shaper_freq_y: 39
#shaper_type_y: mzv
shaper_freq_x: 77
shaper_type_x: 2hump_ei
shaper_freq_y: 47
shaper_type_y: 2hump_ei

#####################################################################
#   Basic Klipper and Printer setup
#####################################################################

[printer]
kinematics: corexy
max_velocity: 300  
max_accel: 3000  			   #Max 4000
max_z_velocity: 15 			#Max 15 for 12V TMC Drivers, can increase for 24V
max_z_accel: 350
square_corner_velocity: 5.0


[idle_timeout]
timeout: 1800

[force_move]
enable_force_move: True

#####################################################################
#   Includes
#####################################################################

[include configs/steppers.cfg]
[include configs/temperature_sensors.cfg]
[include configs/fans.cfg]
[include configs/leds.cfg]
[include configs/display.cfg]

#####################################################################
# 	Macros
#####################################################################

[include macros/print_start_end.cfg]


[gcode_macro CLEAN_DA_NOZZLE]
variable_start_x: 67
variable_start_y: 300
variable_start_z: 4
variable_wipe_dist: 20
variable_wipe_qty: 10
variable_wipe_spd: 200
variable_raise_distance: 10

gcode:
 {% if "xyz" not in printer.toolhead.homed_axes %}
   G28
 {% endif %}
 
 G90                                            ; absolute positioning
 ## Move nozzle to start position
 G1 X{start_x} Y{start_y} F6000
 G1 Z{start_z} F1500

 ## Wipe nozzle
 {% for wipes in range(1, (wipe_qty + 1)) %}
   G1 X{start_x + wipe_dist} F{wipe_spd * 60}
   G1 X{start_x} F{wipe_spd * 60}
 {% endfor %}

 ##m Move nozzle in y t prevent hitting klicky
 G1 Y{270}

 ## Raise nozzle
 G1 Z{raise_distance}


#####################################################################
# 	Homing and Gantry Adjustment Routines
#####################################################################


[safe_z_home]
##	XY Location of the Z Endstop Switch
##	Update -10,-10 to the XY coordinates of your endstop pin 
##	(such as 157,305) after going through Z Endstop Pin
##	Location Definition step.
home_xy_position    :150, 150
speed               :300
z_hop               :10
z_hop_speed         :10.0


[quad_gantry_level]
##	Use QUAD_GANTRY_LEVEL to level a gantry.
##	Min & Max gantry corners - measure from nozzle at MIN (0,0) and 
##	MAX (250, 250), (300,300), or (350,350) depending on your printer size
##	to respective belt positions

#--------------------------------------------------------------------
##	Gantry Corners for 300mm Build
##	Uncomment for 300mm build
gantry_corners:
	-60,-10
	360,370
##	Probe points
points:
	50,25
	50,225
	250,225
	250,25
#--------------------------------------------------------------------
speed: 500
horizontal_move_z: 10
retries: 5
retry_tolerance: 0.0075
max_adjust: 10

########################################
# EXP1 / EXP2 (display) pins
########################################

[board_pins]
aliases:
    # EXP1 header
    EXP1_1=PE8, EXP1_2=PE7,
    EXP1_3=PE9, EXP1_4=PE10,
    EXP1_5=PE12, EXP1_6=PE13,    # Slot in the socket on this side
    EXP1_7=PE14, EXP1_8=PE15,
    EXP1_9=<GND>, EXP1_10=<5V>,

    # EXP2 header
    EXP2_1=PA6, EXP2_2=PA5,
    EXP2_3=PB1, EXP2_4=PA4,
    EXP2_5=PB2, EXP2_6=PA7,      # Slot in the socket on this side
    EXP2_7=PC15, EXP2_8=<RST>,
    EXP2_9=<GND>, EXP2_10=<5V>



#--------------------------------------------------------------------


#####################################################################
# 	Macros
#####################################################################
#[bed_mesh]
#speed: 300
#horizontal_move_z: 20
#mesh_min: 40, 40
#mesh_max: 260,260
#fade_start: 0.6
#fade_end: 10.0
#probe_count: 5,5
#algorithm: bicubic
#relative_reference_index: 12
#zero_reference_position: 150, 150



[include moonraker_obico_macros.cfg]

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 39.628
#*# pid_ki = 1.601
#*# pid_kd = 245.200
#*#
#*# [extruder]
#*#
#*# [stepper_z]
#*# position_endstop = -0.525
#*#
#*# [probe]
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	-0.014819, -0.008004, -0.004085, -0.001784, 0.004996, 0.003313, 0.006462, 0.010559, 0.010776, 0.009690, 0.011839, 0.012176, 0.008215, 0.014637, 0.010626, 0.008196, 0.009033, 0.008359, 0.008156, 0.007325, 0.008874, 0.008930, 0.007636, 0.004112, 0.008072, 0.007145, -0.000398, 0.003603, 0.003581, -0.001664
#*# 	-0.014803, -0.011547, -0.006836, -0.003308, -0.000422, 0.001632, 0.006545, 0.007752, 0.008148, 0.009794, 0.008888, 0.008262, 0.009806, 0.008798, 0.008356, 0.009740, 0.005649, 0.005120, 0.002964, 0.002275, 0.000417, 0.003520, 0.002345, 0.000248, -0.001114, -0.000681, -0.001009, -0.000436, 0.000547, 0.003859
#*# 	-0.017386, -0.008251, -0.007427, -0.008420, 0.001836, 0.001348, 0.001626, 0.009487, 0.006913, 0.004102, 0.013020, 0.009158, 0.006295, 0.008253, 0.010636, 0.001221, 0.000049, 0.006489, 0.001747, -0.005059, -0.001732, 0.001422, -0.005210, -0.006736, -0.002412, -0.004886, -0.006948, 0.001636, 0.002917, -0.002430
#*# 	-0.014162, -0.013261, -0.006420, -0.005814, -0.004832, 0.001731, 0.004788, 0.003200, 0.003285, 0.009046, 0.006571, 0.006505, 0.009728, 0.008338, 0.003230, 0.003268, 0.006976, 0.003208, -0.000136, -0.000067, -0.000882, -0.001625, -0.002439, -0.002901, -0.003346, -0.003232, -0.005749, -0.000853, 0.000860, 0.001724
#*# 	-0.014750, -0.014793, -0.007938, -0.005765, -0.003348, -0.000991, 0.005611, 0.003258, 0.001603, 0.005761, 0.011386, 0.003281, 0.005674, 0.009817, 0.005717, -0.000142, 0.005621, 0.008112, 0.007866, 0.004537, 0.001643, -0.000335, 0.000752, -0.000078, -0.001628, 0.002145, -0.001222, -0.001747, 0.002497, 0.001730
#*# 	-0.014005, -0.010952, -0.007469, -0.005584, -0.003895, 0.000867, 0.000248, -0.000081, 0.004784, 0.003421, 0.003235, 0.004013, 0.008271, 0.006071, 0.003282, 0.006503, 0.009717, 0.005300, 0.003977, 0.010264, 0.005134, 0.002965, 0.006460, 0.004951, -0.002398, 0.001072, 0.006549, 0.006861, 0.001428, 0.003371
#*# 	-0.013977, -0.011304, -0.008588, -0.006622, -0.004631, -0.002502, -0.002031, -0.002895, -0.002455, -0.001972, -0.006503, -0.000393, -0.001891, 0.003998, 0.003487, 0.004798, 0.004169, 0.002754, 0.004133, 0.004020, 0.001359, 0.004618, 0.003088, 0.001244, 0.000046, 0.004810, 0.002606, 0.001578, 0.008088, 0.003867
#*# 	-0.009727, -0.010695, -0.006947, -0.005760, -0.003929, -0.002548, -0.003257, -0.003192, -0.004809, -0.003649, -0.005225, -0.001269, 0.004061, 0.001529, 0.001629, 0.006785, 0.006424, 0.001619, 0.002879, 0.006428, 0.001578, 0.003074, 0.006455, 0.004730, -0.001709, 0.000902, 0.006682, 0.006352, 0.004391, 0.004511
#*# 	-0.014657, -0.011650, -0.010611, -0.009160, -0.002484, -0.004519, -0.009660, -0.006595, -0.002925, -0.006614, -0.008536, 0.001516, -0.001212, -0.003351, 0.000325, 0.003650, -0.000655, -0.004925, 0.001680, -0.001695, -0.003399, -0.000021, 0.003388, -0.000046, -0.004190, 0.001635, 0.000381, 0.001212, 0.003780, 0.003463
#*# 	-0.018394, -0.014649, -0.013156, -0.013585, -0.009909, -0.006472, -0.009822, -0.011487, -0.009724, -0.007879, -0.009927, -0.005911, -0.001583, -0.002837, -0.004425, -0.001272, -0.001344, -0.006572, -0.005655, -0.002791, -0.005180, -0.006508, -0.000020, -0.001672, -0.006788, -0.004981, -0.000117, -0.003679, -0.004955, -0.003291
#*# 	-0.023101, -0.013157, -0.015607, -0.017990, -0.011138, -0.004964, -0.013576, -0.016502, -0.008200, -0.006669, -0.011599, -0.009850, -0.001652, -0.003883, -0.006741, -0.001647, -0.000223, -0.008363, -0.006159, -0.002879, -0.005517, -0.008261, -0.003108, -0.003053, -0.010009, -0.009932, -0.005662, -0.006728, -0.009079, -0.006644
#*# 	-0.023000, -0.019794, -0.018026, -0.016498, -0.012552, -0.009824, -0.012317, -0.011490, -0.011412, -0.010031, -0.008163, -0.004914, -0.003138, -0.005220, -0.002070, -0.003040, -0.004997, -0.005705, -0.004132, -0.001686, -0.004840, -0.002560, -0.003293, -0.008570, -0.009824, -0.008179, -0.009289, -0.011903, -0.010709, -0.009800
#*# 	-0.023135, -0.024051, -0.012768, -0.017041, -0.019689, -0.009631, -0.008301, -0.016509, -0.013158, -0.001734, -0.004181, -0.009066, -0.000233, 0.002457, -0.005853, -0.005206, 0.000800, -0.004569, -0.007336, -0.002506, 0.003724, 0.000693, -0.006540, -0.002010, -0.007419, -0.013025, -0.011534, -0.009398, -0.011532, -0.014786
#*# 	-0.025079, -0.021658, -0.017921, -0.018145, -0.018127, -0.017820, -0.016068, -0.013214, -0.009858, -0.004907, -0.003132, -0.004113, -0.004894, -0.003968, -0.000028, -0.003554, -0.004793, -0.004476, -0.005614, -0.003353, 0.000722, 0.002443, -0.000217, -0.004844, -0.005571, -0.006592, -0.013026, -0.011558, -0.008943, -0.013074
#*# 	-0.024682, -0.021365, -0.017854, -0.019615, -0.023540, -0.019660, -0.014400, -0.014687, -0.009236, -0.006081, -0.003376, -0.008249, -0.005118, -0.002941, -0.005745, -0.005026, -0.006527, -0.003346, -0.008293, -0.004361, -0.000026, -0.001434, -0.003371, -0.003563, -0.003077, -0.011529, -0.010740, -0.009675, -0.011222, -0.010637
#*# 	-0.030337, -0.024845, -0.021396, -0.022054, -0.022773, -0.022820, -0.020666, -0.015903, -0.011853, -0.008191, -0.005008, -0.006257, -0.008331, -0.008905, -0.006644, -0.007627, -0.009192, -0.006580, -0.009123, -0.009847, -0.008695, -0.004731, -0.003481, -0.004944, -0.004822, -0.010596, -0.014608, -0.013037, -0.010607, -0.012378
#*# 	-0.032635, -0.028069, -0.024732, -0.024727, -0.024784, -0.022643, -0.020113, -0.016030, -0.010696, -0.007433, -0.006266, -0.008144, -0.009808, -0.009039, -0.006648, -0.007139, -0.006698, -0.008852, -0.010920, -0.013308, -0.011855, -0.008307, -0.005888, -0.003810, -0.004697, -0.006272, -0.013587, -0.014855, -0.013156, -0.014779
#*# 	-0.036264, -0.033003, -0.029605, -0.030819, -0.028038, -0.025112, -0.021578, -0.017242, -0.012481, -0.009829, -0.010702, -0.011498, -0.011595, -0.010734, -0.008978, -0.008454, -0.006660, -0.010559, -0.014610, -0.013869, -0.014817, -0.013205, -0.011502, -0.005002, -0.004833, -0.007428, -0.012356, -0.014827, -0.017522, -0.019685
#*# 	-0.037163, -0.029833, -0.034722, -0.031941, -0.026368, -0.029563, -0.025525, -0.017665, -0.009872, -0.010588, -0.012239, -0.009849, -0.013188, -0.013181, -0.008168, -0.004830, -0.009921, -0.010316, -0.011468, -0.015811, -0.018358, -0.015651, -0.011427, -0.011498, -0.007188, -0.006077, -0.013002, -0.020494, -0.019686, -0.019753
#*# 	-0.037892, -0.033918, -0.032961, -0.031615, -0.029351, -0.025741, -0.022164, -0.017384, -0.014823, -0.013196, -0.013356, -0.015369, -0.013970, -0.011449, -0.008622, -0.007117, -0.008133, -0.010448, -0.013054, -0.016301, -0.016314, -0.014839, -0.013176, -0.011489, -0.010211, -0.010656, -0.013556, -0.016708, -0.021366, -0.023011
#*# 	-0.034899, -0.031214, -0.028798, -0.026297, -0.023993, -0.021300, -0.017272, -0.014669, -0.012355, -0.011590, -0.011756, -0.012315, -0.011338, -0.009927, -0.006935, -0.004010, -0.003674, -0.006540, -0.008213, -0.008157, -0.009512, -0.009862, -0.009623, -0.010295, -0.011489, -0.009726, -0.011291, -0.013259, -0.016154, -0.019199
#*# 	-0.031361, -0.029690, -0.026345, -0.023952, -0.021336, -0.017882, -0.014738, -0.013035, -0.011575, -0.011125, -0.009370, -0.009914, -0.009878, -0.007801, -0.003675, -0.001609, -0.001624, -0.001686, -0.003339, -0.004623, -0.004866, -0.007146, -0.007433, -0.009908, -0.013072, -0.011400, -0.011463, -0.011072, -0.013008, -0.016133
#*# 	-0.029321, -0.026691, -0.023044, -0.022146, -0.017734, -0.016279, -0.012779, -0.009912, -0.009932, -0.008787, -0.006505, -0.007089, -0.007008, -0.005036, -0.002850, -0.000125, 0.001630, 0.001622, 0.000008, -0.000779, -0.002393, -0.004744, -0.006514, -0.009877, -0.012375, -0.012382, -0.010660, -0.009800, -0.010408, -0.014070
#*# 	-0.031677, -0.026893, -0.025465, -0.023015, -0.019822, -0.016488, -0.016501, -0.014091, -0.011646, -0.009104, -0.006631, -0.006559, -0.005722, -0.004929, -0.002675, 0.000781, 0.001630, 0.001665, 0.000699, -0.001865, -0.003458, -0.006419, -0.006626, -0.010445, -0.013261, -0.013229, -0.012779, -0.009870, -0.009922, -0.013563
#*# 	-0.032715, -0.028864, -0.026763, -0.024269, -0.021514, -0.018185, -0.016287, -0.013992, -0.012315, -0.009956, -0.007794, -0.006638, -0.004841, -0.004220, -0.002013, 0.000083, 0.000568, 0.000173, -0.001805, -0.004653, -0.006589, -0.007624, -0.008107, -0.009891, -0.013230, -0.013630, -0.013422, -0.011495, -0.009783, -0.013759
#*# 	-0.029473, -0.026796, -0.025321, -0.022773, -0.020453, -0.015641, -0.015223, -0.012313, -0.012291, -0.009838, -0.005840, -0.006240, -0.004980, -0.002100, -0.001651, 0.000329, 0.001212, -0.000130, -0.001760, -0.004973, -0.006539, -0.008171, -0.007377, -0.009067, -0.011489, -0.013081, -0.012883, -0.011893, -0.010721, -0.013161
#*# 	-0.024245, -0.022003, -0.020501, -0.017948, -0.016293, -0.011645, -0.009615, -0.009664, -0.006723, -0.005007, -0.001719, -0.001157, 0.000092, 0.001824, 0.003240, 0.003388, 0.004975, 0.004923, 0.003012, 0.001498, -0.000851, -0.003347, -0.003330, -0.005649, -0.008165, -0.007255, -0.008170, -0.009041, -0.008931, -0.009511
#*# 	-0.018261, -0.018830, -0.017207, -0.014618, -0.014096, -0.009664, -0.006641, -0.006600, -0.004786, -0.001666, -0.000233, 0.001060, 0.002813, 0.003126, 0.004058, 0.004112, 0.004598, 0.006252, 0.004977, 0.002829, 0.000152, -0.001784, -0.002071, -0.004969, -0.007769, -0.008180, -0.009689, -0.011490, -0.013614, -0.013062
#*# 	-0.014813, -0.012949, -0.011496, -0.011387, -0.011069, -0.007257, -0.006057, -0.003499, -0.001600, 0.001537, 0.004047, 0.004687, 0.006461, 0.006578, 0.006551, 0.006431, 0.006509, 0.006578, 0.006877, 0.004117, 0.001620, -0.001401, -0.002093, -0.005377, -0.008175, -0.009069, -0.011464, -0.014879, -0.014717, -0.015492
#*# 	-0.010575, -0.009513, -0.008477, -0.009011, -0.008994, -0.006758, -0.005010, -0.002919, -0.000009, 0.003341, 0.006674, 0.008020, 0.009313, 0.009072, 0.008070, 0.006543, 0.006526, 0.008050, 0.008106, 0.004981, 0.003425, -0.000025, -0.001580, -0.005010, -0.008576, -0.011495, -0.013566, -0.016485, -0.018114, -0.018049
#*# tension = 0.2
#*# min_x = 40.0
#*# algo = bicubic
#*# y_count = 30
#*# mesh_y_pps = 2
#*# min_y = 40.0
#*# x_count = 30
#*# max_y = 260.0
#*# mesh_x_pps = 2
#*# max_x = 260.0
#*#
#*# [scanner model default]
#*# model_coef = 1.4528497085156693,
#*# 	  1.7965285734311771,
#*# 	  0.7622092624747974,
#*# 	  0.2509753677589836,
#*# 	  0.43183109504505207,
#*# 	  0.7563441485074416,
#*# 	  -0.32248611563321516,
#*# 	  -0.7987731303222895,
#*# 	  0.3254166625965032,
#*# 	  0.4468013889761828
#*# model_domain = 3.201173432323907e-07,3.3364749210904256e-07
#*# model_range = 0.200000,5.100000
#*# model_temp = 26.281688
#*# model_offset = 0.00000
#*# model_mode = touch
#*# model_fw_version = CARTOGRAPHER 5.0.0
#*#
#*# [scanner]
#*# mode = touch
#*# scanner_touch_threshold = 3250
#*# scanner_touch_speed = 3
